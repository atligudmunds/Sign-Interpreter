<!DOCTYPE html>
<html>
<head>
	 <meta charset="utf-8">
	 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
</head>
<body>
	<!--<div class="page-header">-->
	<h2 id="heading">Hand Sign Translator</h2>
	<!--</div>-->
	
	<div id="jumbo-border">
		<div class="jumbotron">
			<h1 id="output">Display the result here.</h1> 
		</div>
	</div>
	<button type="button" id="left">Left_Button</button>
	<button type="button" id="right">Right_Button</button>
	<p id="handCount">0:Hand(s) detected</p>
	<p id="handHeight"></p>
	<p id="optimalHeight"></p>

	<script src="lib/leap.js"></script>
	<script src="leaptrainer.min.js"></script>
	<script src="responsivevoice.js"></script>
	<script src="trainer-ui/js/jquery.min.js"></script>
	<audio controls hidden id="bleepSound">
           <source src="button-3.mp3" type="audio/mpeg">
      	Your browser does not support the audio element.
    </audio>

	<script>
		$(document).ready(function()
		{
			// Loading all of the HTML id's into objects(for faster lookup)
			var audio = $("#bleepSound")[0];
			var handCounter = $("#handCount");
			var handHeight = $("#handHeight");
			var optimalHeight = $("#optimalHeight");
			var output = $("#output");

			var trainer = new LeapTrainer.Controller(); 

			// ------The Leap Loop-------
			// This loop is just for displaying the number of hands and hand position
			Leap.loop(function(frame) {
				var currentNumOfHands = frame.hands.length
				handCounter.html(currentNumOfHands + ":Hand(s) Detected");
				if(currentNumOfHands == 1) {
					handHeight.html(
						"x: " + frame.hands[0].palmPosition[0] + 
						" y: " + frame.hands[0].palmPosition[1] + 
						" z: " + frame.hands[0].palmPosition[2]);
					if((frame.hands[0].palmPosition[1] < 165) && (frame.hands[0].palmPosition[1] > 95)) {
						optimalHeight.html("Hand in optimal height from sensor");
					}
					else {
						optimalHeight.html("Hand NOT in optimal height from sensor");
					}
				}
			});
			// --------------------------

			// The function that puts the word on the screen, reads it out loud
			// and sends the word to the mobile server
			function process_Word(new_word) {
				responsiveVoice.speak(new_word);
				output.html(new_word);
				$.get("https://sheltered-eyrie-1287.herokuapp.com/change?" + new_word, function(data, status) {
					console.log("Got-from server:" + data);
				});
			};
			
			// super redundant functions that are needed because of some weird error
			function call_left() {
				process_Word("left");
			};
			function call_right() {
				process_Word("right");
			};

			// The functions for the test buttons(they will be removed later)
			$("#left").click(function() {
				process_Word("left");
			});
			$("#right").click(function() {
				process_Word("right");
			});

			

			// Load in all of the gestures and make LeapTrainer start to detect them
			$.get("gestures/left_json.txt", function(data) {
				trainer.fromJSON(data);
				trainer.on('LEFT', call_left);
			}, "text");

			$.get("gestures/right_json.txt", function(data) {
				trainer.fromJSON(data);
				trainer.on('RIGHT', call_right);
			}, "text");

			//trainer.fromJSON(leftJson);

			//trainer.fromJSON('{"name":"LEFT","pose":false,"data":[[{"x":0.5072341485538959,"y":-0.08899765570013117,"z":0.09026355499431876,"stroke":1},{"x":0.3142019294808994,"y":0.013173154575036372,"z":-0.031342463188705094,"stroke":1},{"x":0.3808848540665739,"y":-0.039333993397416576,"z":0.04441945058646635,"stroke":1},{"x":0.02549059135552667,"y":0.040069936371604234,"z":-0.03409532894095907,"stroke":1},{"x":0.23789173478139347,"y":-0.031019998461243925,"z":0.035518398224863856,"stroke":1},{"x":0.24538157740555078,"y":-0.011839029599362366,"z":-0.1316005015852542,"stroke":1},{"x":0.19902138847186113,"y":0.029127294654712074,"z":-0.3457825715006548,"stroke":1},{"x":-0.12318408374044021,"y":0.035418337182237414,"z":-0.043278787616811865,"stroke":1},{"x":-0.05618612078354379,"y":0.0024744175550207026,"z":0.07586380236214202,"stroke":1},{"x":0.10290812166918673,"y":-0.03459517275844425,"z":0.0394172921685525,"stroke":1},{"x":-0.00623258692776385,"y":0.010142305997435958,"z":-0.1541287596358172,"stroke":1},{"x":-0.09660194350446727,"y":0.03713157101391333,"z":-0.20058320731704177,"stroke":1},{"x":-0.15303624538847055,"y":0.03203542186870845,"z":0.018876149472073223,"stroke":1},{"x":-0.005606194954831278,"y":-0.010315673397534947,"z":0.07565005072136355,"stroke":1},{"x":-0.05482759401405457,"y":-0.023063698178250228,"z":0.03486782667705296,"stroke":1},{"x":-0.330290518975001,"y":0.041876581788124076,"z":-0.09310353062000476,"stroke":1},{"x":-0.3371144660975437,"y":0.020242169973462426,"z":0.10466353045413368,"stroke":1},{"x":-0.2116511493373912,"y":-0.024416299447148057,"z":0.2491912984393681,"stroke":1},{"x":-0.14551759061527803,"y":-0.03516953259775625,"z":0.19571023912391955,"stroke":1},{"x":-0.4927658514461041,"y":0.037059862557033016,"z":0.06947355718099457,"stroke":1}],[{"x":0.32978337172307925,"y":-0.030589782457092134,"z":0.17766383387495616,"stroke":1},{"x":0.5175691140131243,"y":-0.060069162154652356,"z":0.03123897012132154,"stroke":1},{"x":0.3985905692359899,"y":-0.040129779745753894,"z":-0.17842959432474634,"stroke":1},{"x":0.22718183358866206,"y":-0.01063871786429911,"z":-0.15499655957393135,"stroke":1},{"x":0.12213633893122844,"y":0.009135552550536052,"z":-0.0008518802604888243,"stroke":1},{"x":0.2907109515306212,"y":-0.029017455627269737,"z":0.09268993594921304,"stroke":1},{"x":0.4529335596090105,"y":-0.042471606975372424,"z":-0.10741842488034534,"stroke":1},{"x":0.21762561264747127,"y":-0.014239090252123464,"z":-0.2785925668307834,"stroke":1},{"x":0.031041576265935733,"y":0.024613320162642435,"z":-0.09398697965386979,"stroke":1},{"x":0.12165571564746747,"y":-0.009840832271166514,"z":0.05825120426886071,"stroke":1},{"x":0.21764166564285126,"y":-0.021059509823706336,"z":0.0014176287892428974,"stroke":1},{"x":0.27221110093115786,"y":-0.016326222590984124,"z":-0.14190427376465797,"stroke":1},{"x":-0.3376226514727311,"y":0.04413899418718528,"z":-0.044494189177993665,"stroke":1},{"x":-0.3767559418212905,"y":0.02269028462835715,"z":0.18606673031992654,"stroke":1},{"x":-0.2033854168973554,"y":0.021119434674421428,"z":0.189879588194256,"stroke":1},{"x":-0.2476806517903244,"y":0.025359193004263716,"z":0.09649470191881732,"stroke":1},{"x":-0.29155626191281026,"y":0.030589302332114834,"z":0.004501624837519813,"stroke":1},{"x":-0.369836069074851,"y":0.029774969420914593,"z":-0.040696223721030045,"stroke":1},{"x":-0.46970858279453215,"y":0.0342629730440175,"z":0.04649236623578634,"stroke":1},{"x":-0.42010494801582965,"y":0.00573274339690967,"z":0.0429389606089724,"stroke":1},{"x":-0.48243088598687567,"y":0.026965392361057355,"z":0.11373514706897259,"stroke":1}],[{"x":0.3476020803593435,"y":-0.05707819809008567,"z":0.06451286423157926,"stroke":1},{"x":0.5045626053261253,"y":-0.06751429811380819,"z":-0.20089339905185824,"stroke":1},{"x":-0.01191614202519331,"y":0.01712316117682809,"z":-0.08059444812970995,"stroke":1},{"x":0.24709012209771875,"y":-0.03589002721192802,"z":0.030847002338701635,"stroke":1},{"x":0.3584005314863691,"y":-0.023484598374966206,"z":-0.23071301582395906,"stroke":1},{"x":-0.17986543024022333,"y":0.03322331180755063,"z":0.007567506720036671,"stroke":1},{"x":0.09881238960659955,"y":-0.014525818582717683,"z":0.03230623107468733,"stroke":1},{"x":0.1637576045811857,"y":0.01942781035071893,"z":-0.2407316382958749,"stroke":1},{"x":-0.09315709714142512,"y":0.030643637538254095,"z":-0.06066199736088898,"stroke":1},{"x":0.002387320862718312,"y":-0.0016015959255469003,"z":0.045994357416557274,"stroke":1},{"x":0.1497128833022332,"y":0.00679467590122021,"z":-0.14896714974600406,"stroke":1},{"x":0.008687668209686361,"y":0.026197518727325064,"z":-0.13204425071158743,"stroke":1},{"x":-0.11731021113475426,"y":0.021270242674776896,"z":0.020756882739366267,"stroke":1},{"x":0.03387812099594578,"y":0.0077272771873797275,"z":-0.0709731415982239,"stroke":1},{"x":-0.3522183500266993,"y":0.053986639759029134,"z":-0.07114131075111232,"stroke":1},{"x":-0.16008404198451748,"y":-0.013158035650446633,"z":0.19259613323114944,"stroke":1},{"x":-0.15482118558531183,"y":-0.013099013426331046,"z":0.19855733975348633,"stroke":1},{"x":-0.15391703768436488,"y":-0.009526320298673362,"z":0.2039578334780197,"stroke":1},{"x":-0.19616443633155628,"y":-0.055209229646543026,"z":0.23857159368686914,"stroke":1},{"x":-0.4954373946738747,"y":0.07469286019796392,"z":0.2010526067987654,"stroke":1}]]}');

			//trainer.fromJSON('{"name":"RIGHT","pose":false,"data":[[{"x":-0.2113180647351836,"y":-0.03251191170939037,"z":0.2562192873888946,"stroke":1},{"x":-0.4735479813593072,"y":0.0475662341814286,"z":0.3524265327809513,"stroke":1},{"x":-0.47309990262187485,"y":0.04255786239638234,"z":0.07019997570858955,"stroke":1},{"x":-0.296724590130685,"y":0.019082254821452323,"z":-0.11643809381758768,"stroke":1},{"x":-0.04941979971732813,"y":-0.03234485246255555,"z":-0.0034280400968334512,"stroke":1},{"x":0.0871916954773686,"y":-0.02881882407496139,"z":0.15463677652229413,"stroke":1},{"x":-0.151433618950785,"y":0.03986748107275489,"z":0.13142194882682795,"stroke":1},{"x":-0.05626556648111669,"y":-0.0030397044767101478,"z":-0.13975122076280497,"stroke":1},{"x":0.1895123514445256,"y":-0.02271114183539729,"z":-0.2117842349460928,"stroke":1},{"x":0.3144726723331174,"y":-0.03558353933853713,"z":0.018636879917312388,"stroke":1},{"x":0.13308518280512838,"y":0.02009330027619957,"z":0.09742267202263472,"stroke":1},{"x":0.14381489111301105,"y":0.004034079349912109,"z":-0.09818981360654094,"stroke":1},{"x":0.31728071218243636,"y":-0.018450728873058417,"z":-0.26902682609691525,"stroke":1},{"x":0.5264520186406928,"y":0.0002594906724804197,"z":-0.2423458438407296,"stroke":1}]]}');

			// Telling LeapTrainer what functions to call when a hand sign is detected
			//trainer.on('LEFT', call_left);
			//trainer.on('RIGHT', call_right);
		});
	</script>
    <style>
		#heading
		{
			padding-left: 25px;
		}

		#jumbo-border
		{
			padding-left: 50px;
			padding-right: 50px;
		}

		h1
		{
			text-align: center;
		}
	</style>
</body>
</html>
